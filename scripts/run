#!/bin/bash
set -euo pipefail

if [ -f .env ]; then
  source .env
fi

DATABASE_URL="${DATABASE_URL:-""}"

if [ -z "${DATABASE_URL}" ]; then
  echo "DATABASE_URL not set." >&2
  exit 1
fi

if [[ "${DATABASE_URL}" = "postgres"* ]]; then
  exec cargo run --color always --no-default-features --features="postgres"
else
  exec cargo run --color always --no-default-features --features="sqlite"
fi
